{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Bobing%20Corp/Desktop/bobing-ssot-new/lib/utils.js"],"sourcesContent":["// lib/utils.js\r\nexport const formatRupiah = (n) => {\r\n  return new Intl.NumberFormat('id-ID', {\r\n    style: 'currency',\r\n    currency: 'IDR',\r\n    minimumFractionDigits: 0\r\n  }).format(n);\r\n};\r\n\r\nexport const sizeRank = ['ALL','ALL SIZE','ALLSIZE','XXXS','XXS','XS','S','M','L','XL','XXL','2XL','3XL','XXXL','4XL','5XL'];\r\n\r\nexport const sortBySize = (variantA, variantB) => {\r\n  const sizeA = (variantA.size || '').toUpperCase().trim();\r\n  const sizeB = (variantB.size || '').toUpperCase().trim();\r\n  const idxA = sizeRank.indexOf(sizeA);\r\n  const idxB = sizeRank.indexOf(sizeB);\r\n  \r\n  if (idxA !== -1 && idxB !== -1) return idxA - idxB;\r\n  if (idxA !== -1) return -1; \r\n  if (idxB !== -1) return 1;\r\n  \r\n  const colorCompare = (variantA.color || '').localeCompare(variantB.color || '');\r\n  if (colorCompare !== 0) return colorCompare;\r\n  \r\n  return (variantA.sku || '').localeCompare(variantB.sku || '');\r\n};"],"names":[],"mappings":"AAAA,eAAe;;;;;;;;;AACR,MAAM,eAAe,CAAC;IAC3B,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QACpC,OAAO;QACP,UAAU;QACV,uBAAuB;IACzB,GAAG,MAAM,CAAC;AACZ;AAEO,MAAM,WAAW;IAAC;IAAM;IAAW;IAAU;IAAO;IAAM;IAAK;IAAI;IAAI;IAAI;IAAK;IAAM;IAAM;IAAM;IAAO;IAAM;CAAM;AAErH,MAAM,aAAa,CAAC,UAAU;IACnC,MAAM,QAAQ,CAAC,SAAS,IAAI,IAAI,EAAE,EAAE,WAAW,GAAG,IAAI;IACtD,MAAM,QAAQ,CAAC,SAAS,IAAI,IAAI,EAAE,EAAE,WAAW,GAAG,IAAI;IACtD,MAAM,OAAO,SAAS,OAAO,CAAC;IAC9B,MAAM,OAAO,SAAS,OAAO,CAAC;IAE9B,IAAI,SAAS,CAAC,KAAK,SAAS,CAAC,GAAG,OAAO,OAAO;IAC9C,IAAI,SAAS,CAAC,GAAG,OAAO,CAAC;IACzB,IAAI,SAAS,CAAC,GAAG,OAAO;IAExB,MAAM,eAAe,CAAC,SAAS,KAAK,IAAI,EAAE,EAAE,aAAa,CAAC,SAAS,KAAK,IAAI;IAC5E,IAAI,iBAAiB,GAAG,OAAO;IAE/B,OAAO,CAAC,SAAS,GAAG,IAAI,EAAE,EAAE,aAAa,CAAC,SAAS,GAAG,IAAI;AAC5D"}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Bobing%20Corp/Desktop/bobing-ssot-new/app/inventory/page.js"],"sourcesContent":["\"use client\";\r\nimport React, { useState, useEffect } from 'react';\r\nimport { db, auth } from '@/lib/firebase';\r\nimport { collection, getDocs, doc, runTransaction, query, orderBy, where, limit, serverTimestamp } from 'firebase/firestore';\r\nimport { sortBySize } from '@/lib/utils';\r\nimport { Portal } from '@/lib/usePortal';\r\nimport toast from 'react-hot-toast';\r\n\r\n// --- KONFIGURASI CACHE ---\r\nconst CACHE_KEY = 'lumina_inventory_v2'; // Key baru untuk versi optimized\r\nconst CACHE_DURATION = 15 * 60 * 1000; // 15 Menit (Data stok inventory tidak perlu realtime detik-an untuk list view)\r\n\r\nexport default function InventoryPage() {\r\n    // --- STATE ---\r\n    const [products, setProducts] = useState([]);\r\n    const [warehouses, setWarehouses] = useState([]);\r\n    const [snapshots, setSnapshots] = useState({}); // Map: variantId_warehouseId -> qty\r\n    const [loading, setLoading] = useState(true);\r\n    \r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [expandedProductId, setExpandedProductId] = useState(null); \r\n    \r\n    // Modals State\r\n    const [modalAdjOpen, setModalAdjOpen] = useState(false);\r\n    const [modalCardOpen, setModalCardOpen] = useState(false);\r\n    \r\n    // Selected Data for Modals\r\n    const [adjData, setAdjData] = useState({});\r\n    const [cardData, setCardData] = useState([]);\r\n\r\n    useEffect(() => { \r\n        fetchData(); \r\n    }, []);\r\n\r\n    // Helper untuk chunking query \"IN\" (Firestore limit 30 per batch)\r\n    const fetchInBatches = async (collectionName, fieldName, values) => {\r\n        const results = [];\r\n        const chunks = [];\r\n        const chunkSize = 30; // Aman di bawah limit 30 Firestore\r\n\r\n        for (let i = 0; i < values.length; i += chunkSize) {\r\n            chunks.push(values.slice(i, i + chunkSize));\r\n        }\r\n\r\n        await Promise.all(chunks.map(async (chunk) => {\r\n            if (chunk.length === 0) return;\r\n            const q = query(collection(db, collectionName), where(fieldName, 'in', chunk));\r\n            const snap = await getDocs(q);\r\n            snap.forEach(d => results.push({ id: d.id, ...d.data() }));\r\n        }));\r\n\r\n        return results;\r\n    };\r\n\r\n    // --- FETCH DATA (Highly Optimized) ---\r\n    const fetchData = async (forceRefresh = false) => {\r\n        setLoading(true);\r\n        try {\r\n            // 1. Cek Cache LocalStorage (Bukan Session)\r\n            if (!forceRefresh && typeof window !== 'undefined') {\r\n                const cached = localStorage.getItem(CACHE_KEY);\r\n                if (cached) {\r\n                    const { products, warehouses, snapshots, timestamp } = JSON.parse(cached);\r\n                    if (Date.now() - timestamp < CACHE_DURATION) {\r\n                        setProducts(products);\r\n                        setWarehouses(warehouses);\r\n                        setSnapshots(snapshots);\r\n                        setLoading(false);\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // 2. Fetch Data Ringan (Warehouses & Products Limit)\r\n            const [snapWh, snapProd] = await Promise.all([\r\n                getDocs(query(collection(db, \"warehouses\"), orderBy(\"created_at\", \"asc\"))),\r\n                getDocs(query(collection(db, \"products\"), orderBy(\"name\", \"asc\"), limit(50))) // Limit 50: Hemat Biaya\r\n            ]);\r\n\r\n            const whList = []; \r\n            snapWh.forEach(d => whList.push({id: d.id, ...d.data()}));\r\n            setWarehouses(whList);\r\n\r\n            const prodMap = {};\r\n            const productIds = [];\r\n            snapProd.forEach(d => {\r\n                const p = d.data();\r\n                prodMap[d.id] = { id: d.id, ...p, variants: [], totalStock: 0 };\r\n                productIds.push(d.id);\r\n            });\r\n\r\n            // 3. Targeted Fetching (Hanya data terkait produk yang diambil)\r\n            let vars = [];\r\n            let shots = {};\r\n\r\n            if (productIds.length > 0) {\r\n                // Hanya ambil variants milik 50 produk ini\r\n                vars = await fetchInBatches(\"product_variants\", \"product_id\", productIds);\r\n                \r\n                const variantIds = vars.map(v => v.id);\r\n                \r\n                if (variantIds.length > 0) {\r\n                    // Hanya ambil snapshots milik variants ini\r\n                    const snapshotList = await fetchInBatches(\"stock_snapshots\", \"variant_id\", variantIds);\r\n                    snapshotList.forEach(s => {\r\n                        shots[`${s.variant_id}_${s.warehouse_id}`] = s.qty || 0; // Mapping ID manual jika perlu, atau pakai ID dokumen\r\n                        shots[s.id] = s.qty || 0; // Fallback access\r\n                    });\r\n                }\r\n            }\r\n            \r\n            setSnapshots(shots);\r\n\r\n            // Mapping Logic\r\n            vars.forEach(v => {\r\n                if (prodMap[v.product_id]) {\r\n                    let total = 0;\r\n                    whList.forEach(w => {\r\n                        // Coba akses pakai ID komposit standar\r\n                        const key = `${v.id}_${w.id}`;\r\n                        total += (shots[key] || 0);\r\n                    });\r\n                    prodMap[v.product_id].variants.push(v);\r\n                    prodMap[v.product_id].totalStock += total;\r\n                }\r\n            });\r\n\r\n            const sorted = Object.values(prodMap).sort((a,b) => b.totalStock - a.totalStock);\r\n            setProducts(sorted);\r\n\r\n            // 4. Simpan Cache\r\n            if (typeof window !== 'undefined') {\r\n                localStorage.setItem(CACHE_KEY, JSON.stringify({\r\n                    products: sorted,\r\n                    warehouses: whList,\r\n                    snapshots: shots,\r\n                    timestamp: Date.now()\r\n                }));\r\n            }\r\n\r\n        } catch (e) { \r\n            console.error(\"Inventory Fetch Error:\", e); \r\n            toast.error(\"Gagal memuat stok\");\r\n        } finally { \r\n            setLoading(false); \r\n        }\r\n    };\r\n\r\n    // --- SEARCH LOGIC (Client Side Filter for Cached Data) ---\r\n    // Note: Untuk dataset besar (>1000), sebaiknya buat fungsi search khusus ke server\r\n    const filteredProducts = products.filter(p => \r\n        p.name.toLowerCase().includes(searchTerm.toLowerCase()) || \r\n        p.base_sku.toLowerCase().includes(searchTerm.toLowerCase())\r\n    );\r\n\r\n    const toggleAccordion = (id) => {\r\n        setExpandedProductId(expandedProductId === id ? null : id);\r\n    };\r\n\r\n    // --- ACTIONS ---\r\n    const openOpname = (v, prodName) => {\r\n        setAdjData({ \r\n            variantId: v.id, sku: v.sku, productName: prodName, \r\n            warehouseId: warehouses[0]?.id, \r\n            currentQty: snapshots[`${v.id}_${warehouses[0]?.id}`] || 0, \r\n            realQty: '', note: ''\r\n        });\r\n        setModalAdjOpen(true);\r\n    };\r\n\r\n    const handleAdjWarehouseChange = (e) => {\r\n        const whId = e.target.value;\r\n        setAdjData(prev => ({ ...prev, warehouseId: whId, currentQty: snapshots[`${prev.variantId}_${whId}`] || 0 }));\r\n    };\r\n\r\n    const submitOpname = async (e) => {\r\n        e.preventDefault();\r\n        const diff = parseInt(adjData.realQty) - adjData.currentQty;\r\n        if (isNaN(diff) || diff === 0) return toast.error(\"Tidak ada perubahan.\");\r\n\r\n        const toastId = toast.loading(\"Mengupdate stok...\");\r\n        try {\r\n            await runTransaction(db, async (t) => {\r\n                // 1. Catat Movement\r\n                const mRef = doc(collection(db, \"stock_movements\"));\r\n                t.set(mRef, { \r\n                    variant_id: adjData.variantId, warehouse_id: adjData.warehouseId, type: 'adjustment', \r\n                    qty: diff, ref_id: mRef.id, ref_type: 'opname', date: serverTimestamp(), \r\n                    notes: adjData.note, created_by: auth.currentUser?.email || 'system'\r\n                });\r\n\r\n                // 2. Update Snapshot (Pakai ID Composite variantId_warehouseId)\r\n                const snapshotId = `${adjData.variantId}_${adjData.warehouseId}`;\r\n                const sRef = doc(db, \"stock_snapshots\", snapshotId);\r\n                const sDoc = await t.get(sRef);\r\n                \r\n                if(sDoc.exists()) {\r\n                    t.update(sRef, { qty: parseInt(adjData.realQty) });\r\n                } else {\r\n                    t.set(sRef, { \r\n                        id: snapshotId, \r\n                        variant_id: adjData.variantId, \r\n                        warehouse_id: adjData.warehouseId, \r\n                        qty: parseInt(adjData.realQty) \r\n                    });\r\n                }\r\n            });\r\n            \r\n            toast.success(\"Stok berhasil diupdate!\", { id: toastId });\r\n            \r\n            // Invalidate Cache & Refresh\r\n            if (typeof window !== 'undefined') localStorage.removeItem(CACHE_KEY);\r\n            setModalAdjOpen(false);\r\n            fetchData(true);\r\n\r\n        } catch (e) { \r\n            console.error(e);\r\n            toast.error(`Gagal: ${e.message}`, { id: toastId });\r\n        }\r\n    };\r\n\r\n    const openCard = async (vId, sku) => {\r\n        setModalCardOpen(true); setCardData(null);\r\n        try {\r\n            // Query history tetap on-demand (tidak di-cache agresif karena realtime)\r\n            const q = query(collection(db, \"stock_movements\"), where(\"variant_id\", \"==\", vId), orderBy(\"date\", \"desc\"), limit(20));\r\n            const snap = await getDocs(q);\r\n            setCardData(snap.docs.map(d => ({id: d.id, ...d.data()})));\r\n        } catch (e) { setCardData([]); }\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6 fade-in pb-20\">\r\n            {/* --- HEADER SECTION (FIXED & SOLID) --- */}\r\n                <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-lumina-base px-4 md:px-8 py-4 border-b border-lumina-border/50 shadow-md sticky top-0 z-30 md:static\">\r\n                <div>\r\n                    <h2 className=\"text-xl md:text-3xl font-display font-semibold text-lumina-text tracking-tight\">\r\n                    Inventory Control\r\n                    </h2>\r\n                    <p className=\"text-sm text-lumina-muted mt-1 font-light hidden md:block\">\r\n                    Monitor stok fisik & virtual secara real-time.\r\n                    </p>\r\n                </div>\r\n                {/* Search input */}\r\n                <div className=\"w-full md:w-80 bg-lumina-surface p-1.5 rounded-xl border border-lumina-border shadow-lg flex items-center focus-within:ring-1 focus-within:ring-lumina-gold transition-all\">\r\n                    <div className=\"pl-3 text-lumina-muted\">\r\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"/></svg>\r\n                    </div>\r\n                    <input \r\n                    type=\"text\" \r\n                    placeholder=\"Search Product or SKU...\" \r\n                    className=\"w-full bg-transparent text-lumina-text text-sm px-3 py-2 outline-none placeholder:text-lumina-muted/50 font-mono\"\r\n                    value={searchTerm}\r\n                    onChange={(e) => setSearchTerm(e.target.value)}\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n            {/* --- DESKTOP VIEW (TABLE) --- */}\r\n            <div className=\"hidden md:block card-luxury overflow-hidden min-h-[500px]\">\r\n                <div className=\"table-wrapper-dark border-none shadow-none rounded-none\">\r\n                    <table className=\"table-dark\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th className=\"w-16 pl-6\">Img</th>\r\n                                <th>Product Name</th>\r\n                                <th>Base SKU</th>\r\n                                <th className=\"text-center\">Category</th>\r\n                                <th className=\"text-right pr-8\">Total Stock</th>\r\n                                <th className=\"w-10\"></th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {loading ? (\r\n                                <tr><td colSpan=\"6\" className=\"px-6 py-12 text-center text-lumina-muted animate-pulse\">Loading Inventory Data...</td></tr>\r\n                            ) : filteredProducts.length === 0 ? (\r\n                                <tr><td colSpan=\"6\" className=\"px-6 py-12 text-center text-lumina-muted\">No products found.</td></tr>\r\n                            ) : (\r\n                                filteredProducts.map(p => {\r\n                                    const isExpanded = expandedProductId === p.id;\r\n                                    const isLowStock = p.totalStock <= 10;\r\n                                    \r\n                                    return (\r\n                                        <React.Fragment key={p.id}>\r\n                                            {/* PARENT ROW */}\r\n                                            <tr \r\n                                                onClick={() => toggleAccordion(p.id)}\r\n                                                className={`group cursor-pointer transition-all duration-200 ${isExpanded ? 'bg-lumina-highlight/30 border-l-4 border-l-lumina-gold' : 'hover:bg-lumina-highlight/20 border-l-4 border-l-transparent'}`}\r\n                                            >\r\n                                                <td className=\"pl-6 py-4\">\r\n                                                    <div className=\"w-12 h-12 rounded-lg bg-lumina-base border border-lumina-border flex items-center justify-center overflow-hidden shadow-inner\">\r\n                                                        {p.image_url ? (\r\n                                                            <img src={p.image_url} alt=\"Product\" className=\"w-full h-full object-cover\" />\r\n                                                        ) : (\r\n                                                            <svg className=\"w-5 h-5 text-lumina-muted opacity-30\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"/></svg>\r\n                                                        )}\r\n                                                    </div>\r\n                                                </td>\r\n                                                <td className=\"px-6 py-4\">\r\n                                                    <div className=\"font-display font-medium text-lumina-text text-base group-hover:text-lumina-gold transition-colors\">{p.name}</div>\r\n                                                    <div className=\"text-xs text-lumina-muted mt-1\">{p.variants.length} Variants</div>\r\n                                                </td>\r\n                                                <td className=\"px-6 py-4\">\r\n                                                    <span className=\"font-mono text-sm text-lumina-muted group-hover:text-white transition-colors\">{p.base_sku}</span>\r\n                                                </td>\r\n                                                <td className=\"px-6 py-4 text-center\">\r\n                                                    <span className=\"badge-luxury badge-neutral\">{p.category}</span>\r\n                                                </td>\r\n                                                <td className=\"px-6 py-4 text-right pr-8\">\r\n                                                    <span className={`text-lg font-mono font-bold ${p.totalStock === 0 ? 'text-rose-500' : (isLowStock ? 'text-amber-500' : 'text-emerald-400')}`}>\r\n                                                        {p.totalStock}\r\n                                                    </span>\r\n                                                </td>\r\n                                                <td className=\"px-6 py-4 text-right\">\r\n                                                    <span className={`transform transition-transform duration-300 text-lumina-gold inline-block ${isExpanded ? 'rotate-180' : 'rotate-0'}`}>\r\n                                                        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 9l-7 7-7-7\"/></svg>\r\n                                                    </span>\r\n                                                </td>\r\n                                            </tr>\r\n\r\n                                            {/* EXPANDED CONTENT */}\r\n                                            {isExpanded && (\r\n                                                <tr className=\"bg-[#0F1115] shadow-inner border-b border-lumina-border\">\r\n                                                    <td colSpan=\"6\" className=\"p-0\">\r\n                                                        <div className=\"p-6 fade-in\">\r\n                                                            <div className=\"border border-lumina-border rounded-lg overflow-hidden w-full bg-lumina-base\">\r\n                                                                <table className=\"w-full text-sm text-left\">\r\n                                                                    <thead className=\"bg-lumina-surface text-[10px] text-lumina-muted uppercase tracking-wider font-semibold border-b border-lumina-border\">\r\n                                                                        <tr>\r\n                                                                            <th className=\"px-4 py-3 w-48\">Variant SKU</th>\r\n                                                                            <th className=\"px-4 py-3 w-32\">Spec</th>\r\n                                                                            {warehouses.map(w => (\r\n                                                                                <th key={w.id} className={`px-4 py-3 text-center border-l border-lumina-border ${w.type==='virtual_supplier' ? 'text-indigo-400' : 'text-emerald-500'}`}>\r\n                                                                                    {w.name}\r\n                                                                                </th>\r\n                                                                            ))}\r\n                                                                            <th className=\"px-4 py-3 text-right\">Actions</th>\r\n                                                                        </tr>\r\n                                                                    </thead>\r\n                                                                    <tbody className=\"divide-y divide-lumina-border\">\r\n                                                                        {p.variants.sort(sortBySize).map(v => (\r\n                                                                            <tr key={v.id} className=\"hover:bg-lumina-highlight/20 transition-colors\">\r\n                                                                                <td className=\"px-4 py-3 font-mono text-lumina-gold text-xs font-bold\">{v.sku}</td>\r\n                                                                                <td className=\"px-4 py-3 text-lumina-text\">\r\n                                                                                    <div className=\"flex gap-2\">\r\n                                                                                        <span className=\"badge-luxury badge-neutral\">{v.color}</span>\r\n                                                                                        <span className=\"badge-luxury badge-neutral\">{v.size}</span>\r\n                                                                                    </div>\r\n                                                                                </td>\r\n                                                                                {warehouses.map(w => {\r\n                                                                                    const qty = snapshots[`${v.id}_${w.id}`] || 0;\r\n                                                                                    return (\r\n                                                                                        <td key={w.id} className=\"px-4 py-3 text-center border-l border-lumina-border/30\">\r\n                                                                                            <span className={`font-mono font-medium ${qty > 0 ? 'text-white' : 'text-lumina-border'}`}>\r\n                                                                                                {qty}\r\n                                                                                            </span>\r\n                                                                                        </td>\r\n                                                                                    )\r\n                                                                                })}\r\n                                                                                <td className=\"px-4 py-3 text-right\">\r\n                                                                                    <div className=\"flex justify-end gap-2\">\r\n                                                                                        <button onClick={(e) => { e.stopPropagation(); openOpname(v, p.name); }} className=\"text-[10px] uppercase font-bold text-lumina-muted hover:text-lumina-gold border border-lumina-border hover:border-lumina-gold rounded px-2 py-1 transition-colors\">\r\n                                                                                            Opname\r\n                                                                                        </button>\r\n                                                                                        <button onClick={(e) => { e.stopPropagation(); openCard(v.id, v.sku); }} className=\"text-[10px] uppercase font-bold text-lumina-muted hover:text-white border border-lumina-border hover:border-white rounded px-2 py-1 transition-colors\">\r\n                                                                                            History\r\n                                                                                        </button>\r\n                                                                                    </div>\r\n                                                                                </td>\r\n                                                                            </tr>\r\n                                                                        ))}\r\n                                                                    </tbody>\r\n                                                                </table>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </td>\r\n                                                </tr>\r\n                                            )}\r\n                                        </React.Fragment>\r\n                                    );\r\n                                })\r\n                            )}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n\r\n             {/* --- MOBILE VIEW (CARDS) --- */}\r\n             <div className=\"md:hidden grid grid-cols-1 gap-4\">\r\n                {loading ? (\r\n                    <div className=\"text-center py-10 text-lumina-muted animate-pulse\">Loading Inventory...</div>\r\n                ) : filteredProducts.length === 0 ? (\r\n                     <div className=\"text-center py-10 text-lumina-muted\">No products found.</div>\r\n                ) : (\r\n                    filteredProducts.map(p => {\r\n                         const isExpanded = expandedProductId === p.id;\r\n                         const isLowStock = p.totalStock <= 10;\r\n\r\n                         return (\r\n                             <div key={p.id} onClick={() => toggleAccordion(p.id)} className=\"card-luxury p-4 active:scale-[0.98] transition-transform\">\r\n                                {/* Card Header */}\r\n                                <div className=\"flex gap-4 items-start\">\r\n                                    <div className=\"w-16 h-16 rounded-lg bg-lumina-base border border-lumina-border flex-shrink-0 overflow-hidden\">\r\n                                         {p.image_url ? (\r\n                                            <img src={p.image_url} alt=\"Product\" className=\"w-full h-full object-cover\" />\r\n                                        ) : (\r\n                                            <div className=\"w-full h-full flex items-center justify-center text-lumina-muted\"><span className=\"text-xs\">IMG</span></div>\r\n                                        )}\r\n                                    </div>\r\n                                    <div className=\"flex-1 min-w-0\">\r\n                                        <div className=\"flex justify-between items-start\">\r\n                                             <span className=\"text-xs font-mono font-bold text-lumina-gold bg-lumina-base px-1.5 py-0.5 rounded border border-lumina-border\">{p.base_sku}</span>\r\n                                             <span className={`text-sm font-bold font-mono ${p.totalStock === 0 ? 'text-rose-500' : (isLowStock ? 'text-amber-500' : 'text-emerald-400')}`}>\r\n                                                {p.totalStock} <span className=\"text-[10px] text-lumina-muted font-normal\">qty</span>\r\n                                             </span>\r\n                                        </div>\r\n                                        <h3 className=\"text-sm font-bold text-white mt-1 truncate\">{p.name}</h3>\r\n                                        <div className=\"flex items-center justify-between mt-1\">\r\n                                            <span className=\"text-[10px] text-lumina-muted\">{p.variants.length} Varian</span>\r\n                                            <span className=\"badge-luxury badge-neutral text-[9px]\">{p.category}</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Expanded Content (Variants) */}\r\n                                {isExpanded && (\r\n                                    <div className=\"mt-4 border-t border-lumina-border pt-3 space-y-4 animate-fade-in\">\r\n                                            {p.variants.sort(sortBySize).map(v => (\r\n                                                <div key={v.id} className=\"bg-lumina-base/50 rounded-lg p-3 border border-lumina-border/50\">\r\n                                                    <div className=\"flex justify-between items-center mb-2\">\r\n                                                         <div>\r\n                                                            <div className=\"text-xs font-mono text-lumina-gold\">{v.sku}</div>\r\n                                                            <div className=\"text-[10px] text-white\">{v.color} / {v.size}</div>\r\n                                                         </div>\r\n                                                         <div className=\"flex gap-2\">\r\n                                                             <button onClick={(e) => { e.stopPropagation(); openOpname(v, p.name); }} className=\"px-2 py-1 bg-lumina-surface border border-lumina-border rounded text-[10px] hover:border-lumina-gold text-lumina-muted hover:text-lumina-gold\">Opname</button>\r\n                                                             <button onClick={(e) => { e.stopPropagation(); openCard(v.id, v.sku); }} className=\"px-2 py-1 bg-lumina-surface border border-lumina-border rounded text-[10px] hover:border-white text-lumina-muted hover:text-white\">History</button>\r\n                                                         </div>\r\n                                                    </div>\r\n                                                    \r\n                                                    {/* Warehouse Breakdown (Mobile Grid) */}\r\n                                                    <div className=\"grid grid-cols-2 gap-2\">\r\n                                                        {warehouses.map(w => {\r\n                                                            const qty = snapshots[`${v.id}_${w.id}`] || 0;\r\n                                                            if(w.type === 'virtual_supplier' && qty === 0) return null; \r\n                                                            return (\r\n                                                                <div key={w.id} className=\"flex justify-between items-center text-[10px] bg-lumina-base px-2 py-1 rounded border border-lumina-border/30\">\r\n                                                                    <span className={`truncate max-w-[80px] ${w.type==='virtual_supplier' ? 'text-indigo-400' : 'text-lumina-muted'}`}>{w.name}</span>\r\n                                                                    <span className={`font-mono font-bold ${qty > 0 ? 'text-white' : 'text-lumina-muted/30'}`}>{qty}</span>\r\n                                                                </div>\r\n                                                            )\r\n                                                        })}\r\n                                                    </div>\r\n                                                </div>\r\n                                            ))}\r\n                                    </div>\r\n                                )}\r\n                             </div>\r\n                         );\r\n                    })\r\n                )}\r\n            </div>\r\n\r\n            {/* --- STOCK OPNAME MODAL (FIXED) --- */}\r\n            <Portal>\r\n            {modalAdjOpen && (\r\n                <div className=\"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 fade-in\">\r\n                    <div className=\"bg-lumina-surface rounded-2xl shadow-2xl border border-lumina-border w-full max-w-md flex flex-col max-h-[90vh] overflow-hidden ring-1 ring-lumina-gold/20\">\r\n                        <div className=\"px-6 py-5 border-b border-lumina-border bg-lumina-surface rounded-t-2xl\">\r\n                            <h3 className=\"text-lg font-display font-bold text-white\">Stock Opname</h3>\r\n                            <p className=\"text-xs text-lumina-muted mt-1\">Adjust stock discrepancy.</p>\r\n                        </div>\r\n                        \r\n                        {/* SCROLLABLE FORM */}\r\n                        <div className=\"p-6 space-y-5 overflow-y-auto flex-1\">\r\n                            <div className=\"bg-lumina-base p-4 rounded-lg border border-lumina-border flex justify-between items-center\">\r\n                                <div>\r\n                                    <p className=\"font-mono font-bold text-lumina-gold text-sm\">{adjData.sku}</p>\r\n                                    <p className=\"text-xs text-lumina-text mt-0.5\">{adjData.productName}</p>\r\n                                </div>\r\n                                <div className=\"text-right\">\r\n                                    <p className=\"text-[10px] text-lumina-muted uppercase\">System Qty</p>\r\n                                    <p className=\"text-lg font-bold text-white font-mono\">{adjData.currentQty}</p>\r\n                                </div>\r\n                            </div>\r\n                            \r\n                            <form onSubmit={submitOpname} className=\"space-y-4\">\r\n                                <div>\r\n                                    <label className=\"text-xs font-bold text-lumina-muted uppercase mb-1 block\">Warehouse</label>\r\n                                    <select className=\"input-luxury\" value={adjData.warehouseId} onChange={handleAdjWarehouseChange}>\r\n                                        {warehouses.map(w => <option key={w.id} value={w.id}>{w.name}</option>)}\r\n                                    </select>\r\n                                </div>\r\n                                \r\n                                <div>\r\n                                    <label className=\"text-xs font-bold text-lumina-gold uppercase mb-1 block\">New Physical Quantity</label>\r\n                                    <input type=\"number\" required className=\"input-luxury border-lumina-gold text-center font-bold text-white bg-lumina-gold/10 focus:ring-lumina-gold text-lg py-3\" value={adjData.realQty} onChange={e => setAdjData({...adjData, realQty: e.target.value})} autoFocus placeholder=\"0\" />\r\n                                </div>\r\n                                \r\n                                <div>\r\n                                    <label className=\"text-xs font-bold text-lumina-muted uppercase mb-1 block\">Reason / Notes</label>\r\n                                    <textarea required className=\"input-luxury\" rows=\"2\" value={adjData.note} onChange={e => setAdjData({...adjData, note: e.target.value})} placeholder=\"E.g. Broken goods, Found item...\"></textarea>\r\n                                </div>\r\n                                \r\n                                {/* FOOTER */}\r\n                                <div className=\"flex justify-end gap-3 pt-2 border-t border-lumina-border mt-4\">\r\n                                    <button type=\"button\" onClick={() => setModalAdjOpen(false)} className=\"btn-ghost-dark\">Cancel</button>\r\n                                    <button type=\"submit\" className=\"btn-gold\">Save Adjustment</button>\r\n                                </div>\r\n                            </form>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n            </Portal>\r\n\r\n            {/* --- STOCK CARD MODAL (FIXED) --- */}\r\n            <Portal>\r\n            {modalCardOpen && (\r\n                <div className=\"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 fade-in\">\r\n                    <div className=\"bg-lumina-surface rounded-2xl shadow-2xl border border-lumina-border w-full max-w-2xl flex flex-col max-h-[80vh] overflow-hidden\">\r\n                        <div className=\"px-6 py-5 border-b border-lumina-border flex justify-between items-center bg-lumina-surface\">\r\n                            <h3 className=\"text-lg font-display font-bold text-white\">Stock History</h3>\r\n                            <button onClick={() => setModalCardOpen(false)} className=\"text-lumina-muted hover:text-white text-xl\">âœ•</button>\r\n                        </div>\r\n                        <div className=\"flex-1 overflow-y-auto custom-scrollbar bg-lumina-base\">\r\n                            <table className=\"table-dark w-full\">\r\n                                <thead className=\"sticky top-0 z-10 bg-lumina-surface border-b border-lumina-border\">\r\n                                    <tr><th className=\"pl-6\">Date</th><th>Type</th><th>Warehouse</th><th className=\"text-right\">Qty</th><th>Note</th></tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    {!cardData ? <tr><td colSpan=\"5\" className=\"text-center p-6 text-lumina-muted\">Loading...</td></tr> : cardData.length === 0 ? <tr><td colSpan=\"5\" className=\"text-center p-6 italic text-lumina-muted\">No history found.</td></tr> : cardData.map(m => (\r\n                                        <tr key={m.id}>\r\n                                            <td className=\"pl-6 text-xs text-lumina-muted font-mono\">{new Date(m.date.toDate()).toLocaleDateString()}</td>\r\n                                            <td><span className=\"badge-luxury badge-neutral\">{m.type}</span></td>\r\n                                            <td className=\"text-xs text-lumina-text\">{warehouses.find(w => w.id === m.warehouse_id)?.name}</td>\r\n                                            <td className={`text-right font-mono font-bold ${m.qty > 0 ? 'text-emerald-400' : 'text-rose-400'}`}>{m.qty > 0 ? `+${m.qty}` : m.qty}</td>\r\n                                            <td className=\"text-xs text-lumina-muted truncate max-w-[150px]\">{m.notes}</td>\r\n                                        </tr>\r\n                                    ))}\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n            </Portal>\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":"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"}}]
}