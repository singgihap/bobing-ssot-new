{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Bobing%20Corp/Desktop/bobing-ssot-new/app/finance-accounts/page.js"],"sourcesContent":["// app/finance-accounts/page.js\r\n\"use client\";\r\nimport { useState, useEffect } from 'react';\r\nimport { db } from '@/lib/firebase';\r\nimport { collection, getDocs, doc, updateDoc, deleteDoc, query, orderBy, serverTimestamp, writeBatch } from 'firebase/firestore';\r\nimport * as XLSX from 'xlsx';\r\n\r\nexport default function CoaPage() {\r\n    const [accounts, setAccounts] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => { fetchData(); }, []);\r\n\r\n    const fetchData = async () => {\r\n        try {\r\n            const q = query(collection(db, \"chart_of_accounts\"), orderBy(\"code\", \"asc\"));\r\n            const snap = await getDocs(q);\r\n            const data = [];\r\n            snap.forEach(d => data.push({id: d.id, ...d.data()}));\r\n            setAccounts(data);\r\n        } catch (e) { console.error(e); } finally { setLoading(false); }\r\n    };\r\n\r\n    const toggleStatus = async (id, current) => {\r\n        try {\r\n            const newState = current === 'Aktif' ? 'Nonaktif' : 'Aktif';\r\n            await updateDoc(doc(db, \"chart_of_accounts\", id), { status: newState, updated_at: serverTimestamp() });\r\n            fetchData();\r\n        } catch (e) { alert(e.message); }\r\n    };\r\n\r\n    const deleteAccount = async (id) => {\r\n        if(confirm(\"Hapus akun ini?\")) {\r\n            await deleteDoc(doc(db, \"chart_of_accounts\", id));\r\n            fetchData();\r\n        }\r\n    };\r\n\r\n    const handleImport = (e) => {\r\n        const file = e.target.files[0];\r\n        if (!file) return;\r\n\r\n        const reader = new FileReader();\r\n        reader.onload = async (ev) => {\r\n            try {\r\n                const data = ev.target.result;\r\n                const workbook = XLSX.read(data, { type: 'array' });\r\n                const sheet = workbook.Sheets[workbook.SheetNames[0]];\r\n                const rows = XLSX.utils.sheet_to_json(sheet);\r\n\r\n                if (rows.length === 0) throw new Error(\"File kosong\");\r\n                if (!rows[0]['AccountID']) throw new Error(\"Format salah! Kolom harus: AccountID, Account Name, Account Type\");\r\n                if (!confirm(`Import ${rows.length} akun?`)) return;\r\n\r\n                const batch = writeBatch(db);\r\n                rows.forEach(row => {\r\n                    const docRef = doc(db, \"chart_of_accounts\", String(row['AccountID']));\r\n                    batch.set(docRef, {\r\n                        code: String(row['AccountID']),\r\n                        name: row['Account Name'],\r\n                        category: row['Account Type'],\r\n                        status: 'Aktif',\r\n                        updated_at: serverTimestamp()\r\n                    });\r\n                });\r\n\r\n                await batch.commit();\r\n                alert(\"Import Berhasil!\");\r\n                fetchData();\r\n            } catch (err) { alert(\"Gagal Import: \" + err.message); }\r\n            e.target.value = '';\r\n        };\r\n        reader.readAsArrayBuffer(file);\r\n    };\r\n\r\n    return (\r\n        <div className=\"max-w-7xl mx-auto space-y-6 fade-in pb-20\">\r\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\r\n                <div>\r\n                    <h2 className=\"text-2xl font-semibold text-gray-900 tracking-tight\">Chart of Accounts</h2>\r\n                    <p className=\"text-sm text-gray-500 mt-1\">Master financial accounts (Assets, Liabilities, Equity).</p>\r\n                </div>\r\n                <label className=\"btn-secondary cursor-pointer\">\r\n                    <svg className=\"w-5 h-5 text-brand-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12\"/></svg>\r\n                    <span>Import CSV / Excel</span>\r\n                    <input type=\"file\" className=\"hidden\" accept=\".csv, .xlsx\" onChange={handleImport} />\r\n                </label>\r\n            </div>\r\n\r\n            <div className=\"card p-0 overflow-hidden\">\r\n                <div className=\"table-wrapper border-0 shadow-none rounded-none\">\r\n                    <table className=\"table-modern\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th className=\"pl-6\">Code</th>\r\n                                <th>Account Name</th>\r\n                                <th>Category</th>\r\n                                <th className=\"text-center\">Status</th>\r\n                                <th className=\"text-right pr-6\">Actions</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {loading ? <tr><td colSpan=\"5\" className=\"text-center py-12 text-gray-400\">Loading...</td></tr> : accounts.map(acc => {\r\n                                let catColor = 'badge-neutral';\r\n                                if (acc.category.includes('Aset')) catColor = 'bg-blue-50 text-blue-700 border-blue-100';\r\n                                if (acc.category.includes('Pendapatan')) catColor = 'bg-emerald-50 text-emerald-700 border-emerald-100';\r\n                                if (acc.category.includes('Beban')) catColor = 'bg-rose-50 text-rose-700 border-rose-100';\r\n                                if (acc.category.includes('Kewajiban') || acc.category.includes('Modal')) catColor = 'bg-amber-50 text-amber-700 border-amber-100';\r\n\r\n                                return (\r\n                                    <tr key={acc.id}>\r\n                                        <td className=\"pl-6 font-mono font-bold text-brand-600\">{acc.code}</td>\r\n                                        <td className=\"font-medium text-gray-800\">{acc.name}</td>\r\n                                        <td><span className={`badge ${catColor}`}>{acc.category}</span></td>\r\n                                        \r\n                                        <td className=\"text-center\">\r\n                                            <button onClick={() => toggleStatus(acc.id, acc.status)} \r\n                                                className={`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2 ${acc.status === 'Aktif' ? 'bg-emerald-500' : 'bg-gray-200'}`}\r\n                                            >\r\n                                                <span className={`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${acc.status === 'Aktif' ? 'translate-x-5' : 'translate-x-1'}`} />\r\n                                            </button>\r\n                                        </td>\r\n\r\n                                        <td className=\"text-right pr-6\">\r\n                                            <button onClick={() => deleteAccount(acc.id)} className=\"text-xs font-bold text-red-400 hover:text-red-600\">Del</button>\r\n                                        </td>\r\n                                    </tr>\r\n                                );\r\n                            })}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":"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"}}]
}